(this["webpackJsonpimport-csv-front-end"]=this["webpackJsonpimport-csv-front-end"]||[]).push([[0],{34:function(e,t,s){},37:function(e,t,s){},68:function(e,t,s){"use strict";s.r(t);var n=s(1),a=s.n(n),r=s(9),o=s.n(r),c=(s(34),s(3)),i=s.n(c),l=s(10),u=s(22),d=s(23),h=s(28),p=s(27),m=(s(36),s(24)),f=s.n(m),b=(s(37),s(5)),j=s.n(b),g=s(25),x=s.n(g),O=s(26),v=s(29),y=s(0),k=j.a.CancelToken.source(),w={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.50)"},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"#424242",border:"none",width:"700px"}},N=function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){var e;Object(u.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={fileName:"",file:null,uploading:!1,completed:!1,error:!1,modalIsOpen:!1,username:"",password:"",progress:0,numOfBatches:1,response:""},e}return Object(d.a)(s,[{key:"componentWillUnmount",value:function(){k&&(k.cancel(),this.state.uploading&&this.cancelUpload())}},{key:"cancelUpload",value:function(){j.a.delete("http://localhost:5000/cancel",{auth:{username:this.state.username,password:this.state.password},data:{invoice_number:"0000003Y28X9211"}})}},{key:"onFileUpload",value:function(e){e.target.files.length&&this.setState({fileName:e.target.files[0].name,file:e.target.files[0],data:null})}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}},{key:"openModal",value:function(){this.setState({modalIsOpen:!0})}},{key:"getData",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var s,n,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=C(t.data),this.setState({numOfBatches:s.length}),e.t0=i.a.keys(s);case 3:if((e.t1=e.t0()).done){e.next=11;break}return n=e.t1.value,e.next=7,j()({method:"post",url:"http://localhost:5000/import",auth:{username:this.state.username,password:this.state.password},maxContentLength:1/0,maxBodyLength:1/0,data:{csv:s[n],checkPrevImported:n,lastImport:n<s.length-1},cancelToken:k.token}).then((function(e){if(e.data.continue){var t=a.state.progress;a.setState({progress:t+1})}else a.setState({response:e.data.message,completed:!0})})).catch((function(e){var t=e.response;t&&401===t.status?a.setState({response:"Invalid Credentials",error:!0}):t&&503===t?a.setState({response:"Error Occured Connecting to Database",error:!0}):a.setState({response:"Something went wrong, whoops!",error:!0})}));case 7:if(!this.state.error&&!this.state.completed){e.next=9;break}return e.abrupt("break",11);case 9:e.next=3;break;case 11:this.setState({uploading:!1,completed:!0});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"changePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onSubmit",value:function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({uploading:!0,modalIsOpen:!1}),f.a.parse(this.state.file,{complete:this.getData.bind(this)});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCredentials",value:function(){this.state.file&&this.setState({modalIsOpen:!0})}},{key:"resetPage",value:function(){this.setState({fileName:"",file:null,uploading:!1,completed:!1,error:!1,modalIsOpen:!1,username:"",password:"",progress:0,numOfBatches:1,response:""})}},{key:"render",value:function(){var e=this;return Object(y.jsx)(v.a,{onBeforeunload:function(){return"You\u2019ll lose your data!"},children:Object(y.jsxs)("div",{className:"App p-5",children:[Object(y.jsxs)(x.a,{isOpen:this.state.modalIsOpen,onRequestClose:this.closeModal.bind(this),style:w,contentLabel:"API Credentials",ariaHideApp:!1,children:[Object(y.jsx)("button",{className:"btn btn-danger",onClick:this.closeModal.bind(this),children:"close"}),Object(y.jsxs)("div",{className:"d-flex flex-column m-2 p-5",children:[Object(y.jsx)("h3",{className:"pb-2",children:"Enter Credentials"}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{className:"py-2",htmlFor:"username",children:"Username"}),Object(y.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"username",onChange:this.changeUsername.bind(this)})]}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{className:"py-2",htmlFor:"password",children:"Password"}),Object(y.jsx)("input",{type:"password",className:"form-control",id:"password",placeholder:"password",onChange:this.changePassword.bind(this)})]}),Object(y.jsx)("button",{onMouseUp:function(){return e.onSubmit()},className:"btn btn-primary mt-5",children:"Submit"})]})]}),Object(y.jsx)("h1",{className:"p-5",children:"Import Invoice Charges"}),Object(y.jsxs)("div",{className:"bg-secondary m-auto w-50 d-flex flex-column p-5 rounded",children:[!this.state.uploading&&!this.state.completed&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("h4",{children:"Choose a file to import..."}),Object(y.jsxs)("form",{className:"p-5",children:[Object(y.jsx)("label",{htmlFor:"file-upload",className:"custom-file-upload",children:"Upload File"}),Object(y.jsx)("input",{onChange:function(t){return e.onFileUpload(t)},id:"file-upload",type:"file",accept:".csv"}),Object(y.jsx)("div",{className:"p-2",children:this.state.fileName})]}),Object(y.jsx)("button",{onMouseUp:function(){return e.getCredentials()},className:"btn btn-primary mx-5",children:"Import"})]}),this.state.uploading&&!this.state.completed&&Object(y.jsxs)("div",{className:"d-flex flex-column",children:[Object(y.jsx)("h4",{children:"Importing..."}),Object(y.jsx)("div",{className:"p-3",children:Object(y.jsx)(O.a,{percent:Math.round(this.state.progress/this.state.numOfBatches*100),strokeWidth:"1.2",strokeColor:"#00bc8c"})}),Math.round(this.state.progress/this.state.numOfBatches*100),"%"]}),!this.state.uploading&&this.state.completed&&!this.state.error&&Object(y.jsxs)("div",{className:"d-flex flex-column",children:[Object(y.jsx)("h4",{children:this.state.response}),Object(y.jsx)("button",{onMouseUp:function(){return e.resetPage()},className:"btn btn-primary m-5",children:"Import Another File"})]}),!this.state.uploading&&this.state.completed&&this.state.error&&Object(y.jsxs)("div",{className:"d-flex flex-column",children:[Object(y.jsx)("h4",{children:this.state.response}),Object(y.jsx)("button",{onMouseUp:function(){return e.resetPage()},className:"btn btn-danger m-5",children:"Try Again"})]})]})]})})}}]),s}(n.Component);function C(e){for(var t=[],s=Math.ceil(e.length/500),n=function(s){t[s]="",e.slice(500*s,500*(s+1)).forEach((function(e){t[s]=t[s].concat(e.join("!@#")),t[s]=t[s].concat("\n")}))},a=0;a<s;a++){n(a)}return t}window.onbeforeunload=function(){return""};var S=N,I=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,69)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;s(e),n(e),a(e),r(e),o(e)}))};o.a.render(Object(y.jsx)(a.a.StrictMode,{children:Object(y.jsx)(S,{})}),document.getElementById("root")),I()}},[[68,1,2]]]);
//# sourceMappingURL=main.ae800e6e.chunk.js.map